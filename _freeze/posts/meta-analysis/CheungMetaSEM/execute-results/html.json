{
  "hash": "08b67be8d0802b63533cbd6928efc912",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"CheungMetaSEM\"\nauthor: \"Nduka Boika\"\nformat: html\ndate: \"2025-01-01\"\ncategories: [Readings and Tutorial]\neditor: visual\ncode-fold: true\n---\n\n\n## Some notes on Meta-analytic SEM (MASEM)\nMeta-analysis combines and synthesizes findings with statistical model. So, we are basically taking all the studies we have systematically reviewed, extract the results, and quantitaively analyze the data or the result. By result we mean the effect sizes.\n\nEffect-sizes and variance components are the building block of meta-analysis. \"Effect-sizes\" must satisfy the three conditions below:\n  a. strength - It must tell the magnitude of the relationship or differences between the variables of interest in the model.\n  b. direction - It must tell if the relationship or differences between the variables in the model is positive or negative.\n  c. independence of direction.\n  \n$R^2, \\Delta R^2, \\eta^2, \\omega^2$ are not considered effect sizes because they don't indicate the direction of the magnitude. $\\hat{\\beta}, \\rho , \\Delta \\mu$, odds ratio can be classified as effect sizes. \n\nIn meta-analytic SEM, raw correlation coefficients $y_r = r$ are used and a sampling variance component ($SE^2_r$) = $(1 - r^2)^2/n-1$\n\nThe existing differences in population and observed effect-sizes between studies is termed heterogeneity of effect-sizes ($\\tau^2$). ($\\tau^2$) cannot be compared across effect-sizes because it is specific to a particular effect-size.\n\nWe can quantify the ($\\tau^2$) using one of the following formulas below:\n  - $I^2 = Q - (K - 1)/ Q$; where $I^2$ is -ve then it is truncated to zero (0). ?? what is Q and K.\n  - $I^2 = \\hat{\\tau^2}/(\\hat{\\tau^2} + \\hat{v_i})$ ; where $\\hat{v_i}$ = average sampling variance.\n  \n  Interpretation: this is the proportion of total variation due to differences between studies (heterogeneity)- ratio of between studies variances and total variance. (just like in multi-level modeling).\n  \n  Rule of thumb: $I^2 = $ 25%, 50%, and 75% are considered low, moderate, and high heterogeneity respectively. As sample size increases, $\\hat{v_i}$ becomes smaller and $I^2$ approaches 1.\n  \n:::{.callout-note}\n$I^2$ = absolute measure of heterogeneity, and $I^2$ = relative measure of heterogeneity dependent on $\\hat{v_i}$. Always report both indices.\n:::\n  \nConfidence Intervals \n\nGenerally in Meta Analysis, there are two models: \n\n1. Fixed-effects model:\n  - The population effect-sizes across all studies are assumed to be equal or the same. That is, each of the studies have the same population effect-size. In other words, there is a true effect (in the population, but it is the same for all individual study).\n  - The differences in the observed effect-size is simply due to random (sampling) error attached to each individual studies with a variance of v.\n  - We can only generalize the finding to the other findings related to the studies in the meta-analysis (that is., studies that have the same research design, measure the same number of variables, and the same samples). In other words, we cannot generalize the findings from the meta-analysis in FE beyond the studies (to a general population).\n  \n2. Random-effects model\n  - Population effect-sizes can be different for individual studies.\n  - The differences in the observed effect-sizes are due to a combination random (sampling) error with a variance of v (the difference between the observed and population effect-size) and the True difference (or variance) that is., the difference between the studies effect sizes.\n  - Findings from the meta analysis can be generalized beyond the studies in the meta-analysis.\n  \n## Replicating Cheungs example\n## Univariate approach\n::: {.panel-tabset}\n\n## Random-effects model\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Load the library\nlibrary(metaSEM)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: OpenMx\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nOpenMx may run faster if it is compiled to take advantage of multiple cores.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\"SLSQP\" is set as the default optimizer in OpenMx.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nmxOption(NULL, \"Gradient algorithm\") is set at \"central\".\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nmxOption(NULL, \"Optimality tolerance\") is set at \"6.3e-14\".\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nmxOption(NULL, \"Gradient iterations\") is set at \"2\".\n```\n\n\n:::\n\n```{.r .cell-code}\nhead(Becker83)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  study    di   vi percentage items\n1     1 -0.33 0.03         25     2\n2     2  0.07 0.03         25     2\n3     3 -0.30 0.02         50     2\n4     4  0.35 0.02        100    38\n5     5  0.69 0.07        100    30\n6     6  0.81 0.22        100    45\n```\n\n\n:::\n\n```{.r .cell-code}\n## Random-effects meta-analysis with ML\nsummary(meta(y=di, v=vi, data=Becker83))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nmeta(y = di, v = vi, data = Becker83)\n\n95% confidence intervals: z statistic approximation (robust=FALSE)\nCoefficients:\n            Estimate Std.Error    lbound    ubound z value Pr(>|z|)\nIntercept1  0.174734  0.113378 -0.047482  0.396950  1.5412   0.1233\nTau2_1_1    0.077376  0.054108 -0.028674  0.183426  1.4300   0.1527\n\nQ statistic on the homogeneity of effect sizes: 30.64949\nDegrees of freedom of the Q statistic: 9\nP value of the Q statistic: 0.0003399239\n\nHeterogeneity indices (based on the estimated Tau2):\n                             Estimate\nIntercept1: I2 (Q statistic)   0.6718\n\nNumber of studies (or clusters): 10\nNumber of observed statistics: 10\nNumber of estimated parameters: 2\nDegrees of freedom: 8\n-2 log likelihood: 7.928307 \nOpenMx status1: 0 (\"0\" or \"1\": The optimization is considered fine.\nOther values may indicate problems.)\n```\n\n\n:::\n:::\n\n\n\n## Fixed-effects model\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Fixed-effects meta-analysis by fixing the heterogeneity variance at 0\nsummary( meta(y=di, v=vi, data=Becker83, RE.constraints=0) )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nmeta(y = di, v = vi, data = Becker83, RE.constraints = 0)\n\n95% confidence intervals: z statistic approximation (robust=FALSE)\nCoefficients:\n            Estimate Std.Error    lbound    ubound z value Pr(>|z|)  \nIntercept1  0.100640  0.060510 -0.017957  0.219237  1.6632  0.09627 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nQ statistic on the homogeneity of effect sizes: 30.64949\nDegrees of freedom of the Q statistic: 9\nP value of the Q statistic: 0.0003399239\n\nHeterogeneity indices (based on the estimated Tau2):\n                             Estimate\nIntercept1: I2 (Q statistic)        0\n\nNumber of studies (or clusters): 10\nNumber of observed statistics: 10\nNumber of estimated parameters: 1\nDegrees of freedom: 9\n-2 log likelihood: 17.86043 \nOpenMx status1: 0 (\"0\" or \"1\": The optimization is considered fine.\nOther values may indicate problems.)\n```\n\n\n:::\n:::\n\n\n\n## Mixed-effects model\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Mixed-effects meta-analysis with \"log(items)\" as the predictor\nsummary( meta(y=di, v=vi, x=log(items), data=Becker83) ) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nmeta(y = di, v = vi, x = log(items), data = Becker83)\n\n95% confidence intervals: z statistic approximation (robust=FALSE)\nCoefficients:\n              Estimate   Std.Error      lbound      ubound z value  Pr(>|z|)\nIntercept1 -3.2015e-01  1.0981e-01 -5.3539e-01 -1.0492e-01 -2.9154  0.003552\nSlope1_1    2.1088e-01  4.5084e-02  1.2251e-01  2.9924e-01  4.6774 2.905e-06\nTau2_1_1    1.0000e-10  2.0095e-02 -3.9386e-02  3.9386e-02  0.0000  1.000000\n              \nIntercept1 ** \nSlope1_1   ***\nTau2_1_1      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nQ statistic on the homogeneity of effect sizes: 30.64949\nDegrees of freedom of the Q statistic: 9\nP value of the Q statistic: 0.0003399239\n\nExplained variances (R2):\n                           y1\nTau2 (no predictor)    0.0774\nTau2 (with predictors) 0.0000\nR2                     1.0000\n\nNumber of studies (or clusters): 10\nNumber of observed statistics: 10\nNumber of estimated parameters: 3\nDegrees of freedom: 7\n-2 log likelihood: -4.208024 \nOpenMx status1: 0 (\"0\" or \"1\": The optimization is considered fine.\nOther values may indicate problems.)\n```\n\n\n:::\n:::\n\n\n:::\n\n## TSSEM approach\n\n::: {.panel-tabset}\n\n## Random-effects model\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Load the library\nlibrary(metaSEM)\nhead(Becker83)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  study    di   vi percentage items\n1     1 -0.33 0.03         25     2\n2     2  0.07 0.03         25     2\n3     3 -0.30 0.02         50     2\n4     4  0.35 0.02        100    38\n5     5  0.69 0.07        100    30\n6     6  0.81 0.22        100    45\n```\n\n\n:::\n\n```{.r .cell-code}\n## Random-effects meta-analysis with ML\nsummary(meta(y=di, v=vi, data=Becker83))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nmeta(y = di, v = vi, data = Becker83)\n\n95% confidence intervals: z statistic approximation (robust=FALSE)\nCoefficients:\n            Estimate Std.Error    lbound    ubound z value Pr(>|z|)\nIntercept1  0.174734  0.113378 -0.047482  0.396950  1.5412   0.1233\nTau2_1_1    0.077376  0.054108 -0.028674  0.183426  1.4300   0.1527\n\nQ statistic on the homogeneity of effect sizes: 30.64949\nDegrees of freedom of the Q statistic: 9\nP value of the Q statistic: 0.0003399239\n\nHeterogeneity indices (based on the estimated Tau2):\n                             Estimate\nIntercept1: I2 (Q statistic)   0.6718\n\nNumber of studies (or clusters): 10\nNumber of observed statistics: 10\nNumber of estimated parameters: 2\nDegrees of freedom: 8\n-2 log likelihood: 7.928307 \nOpenMx status1: 0 (\"0\" or \"1\": The optimization is considered fine.\nOther values may indicate problems.)\n```\n\n\n:::\n:::\n\n\n\n## Fixed-effects model\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Fixed-effects meta-analysis by fixing the heterogeneity variance at 0\nsummary( meta(y=di, v=vi, data=Becker83, RE.constraints=0) )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nmeta(y = di, v = vi, data = Becker83, RE.constraints = 0)\n\n95% confidence intervals: z statistic approximation (robust=FALSE)\nCoefficients:\n            Estimate Std.Error    lbound    ubound z value Pr(>|z|)  \nIntercept1  0.100640  0.060510 -0.017957  0.219237  1.6632  0.09627 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nQ statistic on the homogeneity of effect sizes: 30.64949\nDegrees of freedom of the Q statistic: 9\nP value of the Q statistic: 0.0003399239\n\nHeterogeneity indices (based on the estimated Tau2):\n                             Estimate\nIntercept1: I2 (Q statistic)        0\n\nNumber of studies (or clusters): 10\nNumber of observed statistics: 10\nNumber of estimated parameters: 1\nDegrees of freedom: 9\n-2 log likelihood: 17.86043 \nOpenMx status1: 0 (\"0\" or \"1\": The optimization is considered fine.\nOther values may indicate problems.)\n```\n\n\n:::\n:::\n\n\n\n## Mixed-effects model\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Mixed-effects meta-analysis with \"log(items)\" as the predictor\nsummary( meta(y=di, v=vi, x=log(items), data=Becker83) ) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nmeta(y = di, v = vi, x = log(items), data = Becker83)\n\n95% confidence intervals: z statistic approximation (robust=FALSE)\nCoefficients:\n              Estimate   Std.Error      lbound      ubound z value  Pr(>|z|)\nIntercept1 -3.2015e-01  1.0981e-01 -5.3539e-01 -1.0492e-01 -2.9154  0.003552\nSlope1_1    2.1088e-01  4.5084e-02  1.2251e-01  2.9924e-01  4.6774 2.905e-06\nTau2_1_1    1.0000e-10  2.0095e-02 -3.9386e-02  3.9386e-02  0.0000  1.000000\n              \nIntercept1 ** \nSlope1_1   ***\nTau2_1_1      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nQ statistic on the homogeneity of effect sizes: 30.64949\nDegrees of freedom of the Q statistic: 9\nP value of the Q statistic: 0.0003399239\n\nExplained variances (R2):\n                           y1\nTau2 (no predictor)    0.0774\nTau2 (with predictors) 0.0000\nR2                     1.0000\n\nNumber of studies (or clusters): 10\nNumber of observed statistics: 10\nNumber of estimated parameters: 3\nDegrees of freedom: 7\n-2 log likelihood: -4.208024 \nOpenMx status1: 0 (\"0\" or \"1\": The optimization is considered fine.\nOther values may indicate problems.)\n```\n\n\n:::\n:::\n\n\n\n## Handling missing covariates with FIML\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Sample data from Tenenbaum and Leaper (2002, Table 1).\nTenenbaum02 <- Tenenbaum02[, c(\"r\", \"v\", \"Offspring_age\", \"Year_pub\")]\n\n## Set seed for reproducibility\nset.seed(1234567)\n\n## Let's drop 40% in Offspring_age\nmissing_per <- 0.4\n\n## MCAR\nindex <- round(nrow(Tenenbaum02)*missing_per)\nindex <- rep(c(TRUE, FALSE), times=c(index, nrow(Tenenbaum02)-index))\nindex <- sample(index)\nmy.MCAR <- Tenenbaum02\nmy.MCAR[index, \"Offspring_age\"] <- NA\nmy.MCAR$Offspring_age <- scale(my.MCAR$Offspring_age, scale=FALSE)\nmy.MCAR$Year_pub <- scale(my.MCAR$Year_pub, scale=FALSE)\n\nmy.MCAR\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       r            v Offspring_age     Year_pub\n1   0.12 0.0029084053            NA  -4.91666667\n2  -0.08 0.0099721309   -48.3448276   3.08333333\n3  -0.05 0.0103646484   -72.3448276  -7.91666667\n4  -0.08 0.0094022949   -69.3448276  -8.91666667\n5   0.15 0.0013089127   209.6551724  -1.91666667\n6   0.12 0.0404753067   -60.3448276   0.08333333\n7   0.17 0.0052101393            NA   0.08333333\n8   0.34 0.0181898456   107.6551724  -3.91666667\n9  -0.01 0.0020238867            NA   5.08333333\n10  0.33 0.0048124801            NA  10.08333333\n11  0.40 0.0147000000   -93.3448276   1.08333333\n12  0.30 0.0138016667   -90.3448276   4.08333333\n13  0.07 0.0162331805   -57.3448276  13.08333333\n14 -0.02 0.0099920016            NA  -2.91666667\n15  0.19 0.0092910321    -5.3448276  -2.91666667\n16  0.15 0.0006964331    23.6551724  11.08333333\n17  0.19 0.0032148900   -18.3448276   7.08333333\n18  0.02 0.0057097152   -30.3448276  -7.91666667\n19  0.47 0.0085492508            NA  -6.91666667\n20  0.19 0.0046455161     5.6551724  11.08333333\n21  0.33 0.0124071752            NA  -7.91666667\n22  0.06 0.0157589359   -36.3448276  -7.91666667\n23  0.05 0.0033166875            NA   2.08333333\n24  0.24 0.0024877248            NA   5.08333333\n25  0.14 0.0123228738            NA -10.91666667\n26 -0.02 0.0285485760            NA   5.08333333\n27  0.28 0.0066877682            NA  11.08333333\n28  0.14 0.0034825513    35.6551724   9.08333333\n29  0.27 0.0245575546   -42.3448276  -3.91666667\n30  0.38 0.0140779108   -12.3448276 -10.91666667\n31  0.52 0.0212926464            NA  -5.91666667\n32  0.66 0.0127418944    23.6551724  -5.91666667\n33  0.36 0.0303038464    23.6551724  -5.91666667\n34  0.21 0.0042698356    11.6551724  10.08333333\n35  0.19 0.0042231964    11.6551724  10.08333333\n36  0.14 0.0184843108            NA -12.91666667\n37  0.36 0.0102377859    95.6551724  -7.91666667\n38  0.09 0.0006314927    23.6551724  11.08333333\n39  0.16 0.0053946327            NA  13.08333333\n40 -0.07 0.0319427100            NA  -0.91666667\n41  0.36 0.0140295585    89.6551724  -8.91666667\n42  0.36 0.0008270700    95.6551724  -4.91666667\n43  0.22 0.0238300674    -0.3448276   8.08333333\n44  0.04 0.0066899501   -72.3448276   7.08333333\n45  0.06 0.0146001906            NA  -8.91666667\n46  0.41 0.0150447307            NA  -3.91666667\n47  0.04 0.0140394727            NA  -3.91666667\n48  0.23 0.0067954425   -48.3448276   2.08333333\n```\n\n\n:::\n\n```{.r .cell-code}\nfit <- metaFIML(y=r, v=v, x=Offspring_age, av=Year_pub, data=my.MCAR)\nsummary(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nmetaFIML(y = r, v = v, x = Offspring_age, av = Year_pub, data = my.MCAR)\n\n95% confidence intervals: z statistic approximation (robust=FALSE)\nCoefficients:\n              Estimate   Std.Error      lbound      ubound z value  Pr(>|z|)\nTau2_1_1    1.2136e-02  4.5317e-03  3.2543e-03  2.1018e-02  2.6781 0.0074043\nCovX1_X1    4.6116e+03  1.2071e+03  2.2456e+03  6.9775e+03  3.8203 0.0001333\nCovX2_X1   -6.0799e+01  9.3469e+01 -2.4399e+02  1.2240e+02 -0.6505 0.5153883\nCovX2_X2    5.7118e+01  1.1659e+01  3.4267e+01  7.9970e+01  4.8990 9.633e-07\nCovX2_Y1   -1.3300e-01  1.6016e-01 -4.4691e-01  1.8090e-01 -0.8305 0.4062841\nSlope1_1    6.8319e-04  3.5911e-04 -2.0648e-05  1.3870e-03  1.9025 0.0571101\nIntercept1  1.8420e-01  2.1886e-02  1.4130e-01  2.2709e-01  8.4163 < 2.2e-16\nMeanX1      7.7305e-02  1.2402e+01 -2.4230e+01  2.4385e+01  0.0062 0.9950265\nMeanX2     -5.7253e-08  1.0908e+00 -2.1380e+00  2.1380e+00  0.0000 1.0000000\n              \nTau2_1_1   ** \nCovX1_X1   ***\nCovX2_X1      \nCovX2_X2   ***\nCovX2_Y1      \nSlope1_1   .  \nIntercept1 ***\nMeanX1        \nMeanX2        \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nQ statistic on the homogeneity of effect sizes: 179.0075\nDegrees of freedom of the Q statistic: 47\nP value of the Q statistic: 0\n\nExplained variances (R2):\n                           y1\nTau2 (no predictor)    0.0142\nTau2 (with predictors) 0.0121\nR2                     0.1474\n\nNumber of studies (or clusters): 48\nNumber of observed statistics: 9\nNumber of estimated parameters: 9\nDegrees of freedom: 0\n-2 log likelihood: 613.2553 \nOpenMx status1: 0 (\"0\" or \"1\": The optimization is considered fine.\nOther values may indicate problems.)\n```\n\n\n:::\n:::\n\n\n\n:::\n\n\n## TSSEM\n::: {.panel-tabset}\n\n## Random-effects model\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Load the library\nlibrary(metaSEM)\nhead(Becker83)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  study    di   vi percentage items\n1     1 -0.33 0.03         25     2\n2     2  0.07 0.03         25     2\n3     3 -0.30 0.02         50     2\n4     4  0.35 0.02        100    38\n5     5  0.69 0.07        100    30\n6     6  0.81 0.22        100    45\n```\n\n\n:::\n\n```{.r .cell-code}\n## Random-effects meta-analysis with ML\nsummary(meta(y=di, v=vi, data=Becker83))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nmeta(y = di, v = vi, data = Becker83)\n\n95% confidence intervals: z statistic approximation (robust=FALSE)\nCoefficients:\n            Estimate Std.Error    lbound    ubound z value Pr(>|z|)\nIntercept1  0.174734  0.113378 -0.047482  0.396950  1.5412   0.1233\nTau2_1_1    0.077376  0.054108 -0.028674  0.183426  1.4300   0.1527\n\nQ statistic on the homogeneity of effect sizes: 30.64949\nDegrees of freedom of the Q statistic: 9\nP value of the Q statistic: 0.0003399239\n\nHeterogeneity indices (based on the estimated Tau2):\n                             Estimate\nIntercept1: I2 (Q statistic)   0.6718\n\nNumber of studies (or clusters): 10\nNumber of observed statistics: 10\nNumber of estimated parameters: 2\nDegrees of freedom: 8\n-2 log likelihood: 7.928307 \nOpenMx status1: 0 (\"0\" or \"1\": The optimization is considered fine.\nOther values may indicate problems.)\n```\n\n\n:::\n:::\n\n\n\n## Fixed-effects model\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Fixed-effects meta-analysis by fixing the heterogeneity variance at 0\nsummary( meta(y=di, v=vi, data=Becker83, RE.constraints=0) )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nmeta(y = di, v = vi, data = Becker83, RE.constraints = 0)\n\n95% confidence intervals: z statistic approximation (robust=FALSE)\nCoefficients:\n            Estimate Std.Error    lbound    ubound z value Pr(>|z|)  \nIntercept1  0.100640  0.060510 -0.017957  0.219237  1.6632  0.09627 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nQ statistic on the homogeneity of effect sizes: 30.64949\nDegrees of freedom of the Q statistic: 9\nP value of the Q statistic: 0.0003399239\n\nHeterogeneity indices (based on the estimated Tau2):\n                             Estimate\nIntercept1: I2 (Q statistic)        0\n\nNumber of studies (or clusters): 10\nNumber of observed statistics: 10\nNumber of estimated parameters: 1\nDegrees of freedom: 9\n-2 log likelihood: 17.86043 \nOpenMx status1: 0 (\"0\" or \"1\": The optimization is considered fine.\nOther values may indicate problems.)\n```\n\n\n:::\n:::\n\n\n\n## Mixed-effects model\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Mixed-effects meta-analysis with \"log(items)\" as the predictor\nsummary( meta(y=di, v=vi, x=log(items), data=Becker83) ) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nmeta(y = di, v = vi, x = log(items), data = Becker83)\n\n95% confidence intervals: z statistic approximation (robust=FALSE)\nCoefficients:\n              Estimate   Std.Error      lbound      ubound z value  Pr(>|z|)\nIntercept1 -3.2015e-01  1.0981e-01 -5.3539e-01 -1.0492e-01 -2.9154  0.003552\nSlope1_1    2.1088e-01  4.5084e-02  1.2251e-01  2.9924e-01  4.6774 2.905e-06\nTau2_1_1    1.0000e-10  2.0095e-02 -3.9386e-02  3.9386e-02  0.0000  1.000000\n              \nIntercept1 ** \nSlope1_1   ***\nTau2_1_1      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nQ statistic on the homogeneity of effect sizes: 30.64949\nDegrees of freedom of the Q statistic: 9\nP value of the Q statistic: 0.0003399239\n\nExplained variances (R2):\n                           y1\nTau2 (no predictor)    0.0774\nTau2 (with predictors) 0.0000\nR2                     1.0000\n\nNumber of studies (or clusters): 10\nNumber of observed statistics: 10\nNumber of estimated parameters: 3\nDegrees of freedom: 7\n-2 log likelihood: -4.208024 \nOpenMx status1: 0 (\"0\" or \"1\": The optimization is considered fine.\nOther values may indicate problems.)\n```\n\n\n:::\n:::\n\n\n:::\n\n## TSSEM approach\n\n::: {.panel-tabset}\n\n## Random-effects model\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Load the library\nlibrary(metaSEM)\nhead(Becker83)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  study    di   vi percentage items\n1     1 -0.33 0.03         25     2\n2     2  0.07 0.03         25     2\n3     3 -0.30 0.02         50     2\n4     4  0.35 0.02        100    38\n5     5  0.69 0.07        100    30\n6     6  0.81 0.22        100    45\n```\n\n\n:::\n\n```{.r .cell-code}\n## Random-effects meta-analysis with ML\nsummary(meta(y=di, v=vi, data=Becker83))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nmeta(y = di, v = vi, data = Becker83)\n\n95% confidence intervals: z statistic approximation (robust=FALSE)\nCoefficients:\n            Estimate Std.Error    lbound    ubound z value Pr(>|z|)\nIntercept1  0.174734  0.113378 -0.047482  0.396950  1.5412   0.1233\nTau2_1_1    0.077376  0.054108 -0.028674  0.183426  1.4300   0.1527\n\nQ statistic on the homogeneity of effect sizes: 30.64949\nDegrees of freedom of the Q statistic: 9\nP value of the Q statistic: 0.0003399239\n\nHeterogeneity indices (based on the estimated Tau2):\n                             Estimate\nIntercept1: I2 (Q statistic)   0.6718\n\nNumber of studies (or clusters): 10\nNumber of observed statistics: 10\nNumber of estimated parameters: 2\nDegrees of freedom: 8\n-2 log likelihood: 7.928307 \nOpenMx status1: 0 (\"0\" or \"1\": The optimization is considered fine.\nOther values may indicate problems.)\n```\n\n\n:::\n:::\n\n\n\n## Fixed-effects model\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Fixed-effects meta-analysis by fixing the heterogeneity variance at 0\nsummary( meta(y=di, v=vi, data=Becker83, RE.constraints=0) )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nmeta(y = di, v = vi, data = Becker83, RE.constraints = 0)\n\n95% confidence intervals: z statistic approximation (robust=FALSE)\nCoefficients:\n            Estimate Std.Error    lbound    ubound z value Pr(>|z|)  \nIntercept1  0.100640  0.060510 -0.017957  0.219237  1.6632  0.09627 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nQ statistic on the homogeneity of effect sizes: 30.64949\nDegrees of freedom of the Q statistic: 9\nP value of the Q statistic: 0.0003399239\n\nHeterogeneity indices (based on the estimated Tau2):\n                             Estimate\nIntercept1: I2 (Q statistic)        0\n\nNumber of studies (or clusters): 10\nNumber of observed statistics: 10\nNumber of estimated parameters: 1\nDegrees of freedom: 9\n-2 log likelihood: 17.86043 \nOpenMx status1: 0 (\"0\" or \"1\": The optimization is considered fine.\nOther values may indicate problems.)\n```\n\n\n:::\n:::\n\n\n\n## Mixed-effects model\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Mixed-effects meta-analysis with \"log(items)\" as the predictor\nsummary( meta(y=di, v=vi, x=log(items), data=Becker83) ) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nmeta(y = di, v = vi, x = log(items), data = Becker83)\n\n95% confidence intervals: z statistic approximation (robust=FALSE)\nCoefficients:\n              Estimate   Std.Error      lbound      ubound z value  Pr(>|z|)\nIntercept1 -3.2015e-01  1.0981e-01 -5.3539e-01 -1.0492e-01 -2.9154  0.003552\nSlope1_1    2.1088e-01  4.5084e-02  1.2251e-01  2.9924e-01  4.6774 2.905e-06\nTau2_1_1    1.0000e-10  2.0095e-02 -3.9386e-02  3.9386e-02  0.0000  1.000000\n              \nIntercept1 ** \nSlope1_1   ***\nTau2_1_1      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nQ statistic on the homogeneity of effect sizes: 30.64949\nDegrees of freedom of the Q statistic: 9\nP value of the Q statistic: 0.0003399239\n\nExplained variances (R2):\n                           y1\nTau2 (no predictor)    0.0774\nTau2 (with predictors) 0.0000\nR2                     1.0000\n\nNumber of studies (or clusters): 10\nNumber of observed statistics: 10\nNumber of estimated parameters: 3\nDegrees of freedom: 7\n-2 log likelihood: -4.208024 \nOpenMx status1: 0 (\"0\" or \"1\": The optimization is considered fine.\nOther values may indicate problems.)\n```\n\n\n:::\n:::\n\n\n\n## Handling missing covariates\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Sample data from Tenenbaum and Leaper (2002, Table 1).\nTenenbaum02 <- Tenenbaum02[, c(\"r\", \"v\", \"Offspring_age\", \"Year_pub\")]\n\n## Set seed for reproducibility\nset.seed(1234567)\n\n## Let's drop 40% in Offspring_age\nmissing_per <- 0.4\n\n## MCAR\nindex <- round(nrow(Tenenbaum02)*missing_per)\nindex <- rep(c(TRUE, FALSE), times=c(index, nrow(Tenenbaum02)-index))\nindex <- sample(index)\nmy.MCAR <- Tenenbaum02\nmy.MCAR[index, \"Offspring_age\"] <- NA\nmy.MCAR$Offspring_age <- scale(my.MCAR$Offspring_age, scale=FALSE)\nmy.MCAR$Year_pub <- scale(my.MCAR$Year_pub, scale=FALSE)\n\nmy.MCAR\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       r            v Offspring_age     Year_pub\n1   0.12 0.0029084053            NA  -4.91666667\n2  -0.08 0.0099721309   -48.3448276   3.08333333\n3  -0.05 0.0103646484   -72.3448276  -7.91666667\n4  -0.08 0.0094022949   -69.3448276  -8.91666667\n5   0.15 0.0013089127   209.6551724  -1.91666667\n6   0.12 0.0404753067   -60.3448276   0.08333333\n7   0.17 0.0052101393            NA   0.08333333\n8   0.34 0.0181898456   107.6551724  -3.91666667\n9  -0.01 0.0020238867            NA   5.08333333\n10  0.33 0.0048124801            NA  10.08333333\n11  0.40 0.0147000000   -93.3448276   1.08333333\n12  0.30 0.0138016667   -90.3448276   4.08333333\n13  0.07 0.0162331805   -57.3448276  13.08333333\n14 -0.02 0.0099920016            NA  -2.91666667\n15  0.19 0.0092910321    -5.3448276  -2.91666667\n16  0.15 0.0006964331    23.6551724  11.08333333\n17  0.19 0.0032148900   -18.3448276   7.08333333\n18  0.02 0.0057097152   -30.3448276  -7.91666667\n19  0.47 0.0085492508            NA  -6.91666667\n20  0.19 0.0046455161     5.6551724  11.08333333\n21  0.33 0.0124071752            NA  -7.91666667\n22  0.06 0.0157589359   -36.3448276  -7.91666667\n23  0.05 0.0033166875            NA   2.08333333\n24  0.24 0.0024877248            NA   5.08333333\n25  0.14 0.0123228738            NA -10.91666667\n26 -0.02 0.0285485760            NA   5.08333333\n27  0.28 0.0066877682            NA  11.08333333\n28  0.14 0.0034825513    35.6551724   9.08333333\n29  0.27 0.0245575546   -42.3448276  -3.91666667\n30  0.38 0.0140779108   -12.3448276 -10.91666667\n31  0.52 0.0212926464            NA  -5.91666667\n32  0.66 0.0127418944    23.6551724  -5.91666667\n33  0.36 0.0303038464    23.6551724  -5.91666667\n34  0.21 0.0042698356    11.6551724  10.08333333\n35  0.19 0.0042231964    11.6551724  10.08333333\n36  0.14 0.0184843108            NA -12.91666667\n37  0.36 0.0102377859    95.6551724  -7.91666667\n38  0.09 0.0006314927    23.6551724  11.08333333\n39  0.16 0.0053946327            NA  13.08333333\n40 -0.07 0.0319427100            NA  -0.91666667\n41  0.36 0.0140295585    89.6551724  -8.91666667\n42  0.36 0.0008270700    95.6551724  -4.91666667\n43  0.22 0.0238300674    -0.3448276   8.08333333\n44  0.04 0.0066899501   -72.3448276   7.08333333\n45  0.06 0.0146001906            NA  -8.91666667\n46  0.41 0.0150447307            NA  -3.91666667\n47  0.04 0.0140394727            NA  -3.91666667\n48  0.23 0.0067954425   -48.3448276   2.08333333\n```\n\n\n:::\n:::\n\n\n:::\n\n\n\n\n\n\n\n#::::: columns\n#::: {.column width=\"40%\"}\n#:::\n\n#::: {.column width=\"60%\"}\n#:::\n#:::::\n\n#::: notes\n#No notes\n#:::\n\n#::: aside\n#Some additional commentary of more peripheral interest.\n#:::\n\n\n\n\n\n::: {.cell output-location='slide'}\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 37 rows containing non-finite outside the scale range\n(`stat_smooth()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 37 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](CheungMetaSEM_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n#::: panel-tabset\n### Tab A\n\n\n\n::: {.cell output-location='slide'}\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 37 rows containing non-finite outside the scale range\n(`stat_smooth()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 37 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](CheungMetaSEM_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n\n### Tab B\n\nContent for `Tab B`\n:::\n\n##  {background-color=\"aquamarine\"}\n\n(A slide with no title)\n\n##  {background-color=\"black\" background-image=\"https://placekitten.com/100/100\" background-size=\"100px\" background-repeat=\"repeat\"}\n\n(Another slide with no title)\n\n## Slide Title {background-gradient=\"linear-gradient(to bottom, #283b95, #17b2c3)\"}\n\n## Slide Title {background-gradient=\"radial-gradient(#283b95, #17b2c3)\"}\n\n[^1]: A footnote\n\n\n\n\n",
    "supporting": [
      "CheungMetaSEM_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}