{
  "hash": "fe6171c2f654ab399033d2480aaa93ec",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Meta-analysis\"\nauthor: \"Nduka Boika\"\nformat: html\ndate: \"2025-01-01\"\ncategories: [R Tutorial]\n---\n\n\n\n\n\n\n#### Crystal Lewis\n\n#### 11/12/2019\n\n#### Install and call packages we need\n\nInstall packages\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(c(\"tidyverse\", \"lubridate\",\"labelled\", \"dataMaid\", \"janitor\"))\n```\n:::\n\n\n\n\nCall the packages\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(lubridate)\nlibrary(labelled)\n```\n:::\n\n\n\n\nWhat does our data currently look like?\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 8\n  `School District`   `Student Name` `Student ID` Race  `Student Gender` ZipCode\n  <chr>               <chr>          <chr>        <chr>            <dbl>   <dbl>\n1 Primary School - D… LastName, Fir… 71111337335  W                    1  555444\n2 Middle School - Di… LastName, Fir… *            W                    2  555444\n3 Primary School - D… LastName, Fir… 71113153739  B                    2  555444\n# ℹ 2 more variables: `% present fall` <chr>, `% present spring` <dbl>\n```\n\n\n:::\n\n::: {.cell-output-display}\n\n\n|School District             |Student Name        |Student ID  |Race | Student Gender| ZipCode|% present fall | % present spring|\n|:---------------------------|:-------------------|:-----------|:----|--------------:|-------:|:--------------|----------------:|\n|Primary School - District A |LastName, FirstName |71111337335 |W    |              1|  555444|99.42%         |            93.86|\n|Middle School - District A  |LastName, FirstName |*           |W    |              2|  555444|97.37%         |            96.78|\n|Primary School - District A |LastName, FirstName |71113153739 |B    |              2|  555444|97.08%         |            93.86|\n\n\n:::\n:::\n\n\n\n\nWhat do we want our data to look like?\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 7\n  School      District Student_ID Race  Gender Fall_Attendance Spring_Attendance\n  <chr>       <chr>         <dbl> <chr> <chr>            <dbl>             <dbl>\n1 Primary Sc… Distric…    7.11e10 White Male              99.4              93.9\n2 Primary Sc… Distric…    7.11e10 Black Female            97.1              93.9\n3 High School Distric…    7.11e10 White Male              94.4              96.5\n4 High School Distric…    7.11e10 Black Male              96.8              94.7\n5 Primary Sc… Distric…    7.11e10 White Male              96.8              94.2\n6 High School Distric…    7.11e10 White Female            98.0              99.1\n```\n\n\n:::\n\n::: {.cell-output-display}\n\n\n|School         |District   |  Student_ID|Race  |Gender | Fall_Attendance| Spring_Attendance|\n|:--------------|:----------|-----------:|:-----|:------|---------------:|-----------------:|\n|Primary School |District A | 71111337335|White |Male   |           99.42|             93.86|\n|Primary School |District A | 71113153739|Black |Female |           97.08|             93.86|\n|High School    |District A | 71113195575|White |Male   |           94.44|             96.49|\n\n\n:::\n:::\n\n\n\n\n##### My plan\n\n###### (1) Read the data in\n\n###### (2) Select variables to keep\n\n###### (3) Rename variables\n\n###### (4) Filter out Students with NA Student IDs\n\n###### (5) Check for any duplicate rows\n\n###### (6) Transform the School District column\n\n###### (7) Remove the % sign from the Fall_Attendance column\n\n###### (8) Recode Race and Gender\n\n###### (9) Add variable labels\n\nRead in our demographics file using `read_csv`\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDemo <- read_csv('https://raw.githubusercontent.com/Cghlewis/R-Ladies-STL-Cleaning-Data-R/master/Data/Demographics.csv', na=\"*\")\n```\n:::\n\n\n\n\nDrop StudentName and ZipCode using `select`\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(Demo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"School District\"  \"Student Name\"     \"Student ID\"       \"Race\"            \n[5] \"Student Gender\"   \"ZipCode\"          \"% present fall\"   \"% present spring\"\n```\n\n\n:::\n\n```{.r .cell-code}\nDemo <- Demo%>%select(-`Student Name`, -ZipCode)\n```\n:::\n\n\n\n\nRename Columns using `setNames`\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(Demo)\nDemo <- Demo %>% setNames(c(\"School_District\", \"Student_ID\",\"Race\", \"Gender\",\n                                \"Fall_Attendance\", \"Spring_Attendance\"))\n```\n:::\n\n\n\n\nFilter out any NA StudentID using `filter`\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(Demo$Student_ID)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     Min.   1st Qu.    Median      Mean   3rd Qu.      Max.      NA's \n7.111e+10 7.320e+10 7.557e+10 7.557e+10 7.793e+10 8.000e+10         2 \n```\n\n\n:::\n\n```{.r .cell-code}\nDemo <- Demo %>% filter(!is.na(Student_ID))\n\nsummary(Demo$Student_ID)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. \n7.111e+10 7.320e+10 7.557e+10 7.557e+10 7.793e+10 8.000e+10 \n```\n\n\n:::\n:::\n\n\n\n\nCheck for duplicates and remove using `distinct`\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndim(Demo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1382    6\n```\n\n\n:::\n\n```{.r .cell-code}\ndistinct(Demo) %>% count()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 1\n      n\n  <int>\n1  1380\n```\n\n\n:::\n\n```{.r .cell-code}\nDemo <- distinct(Demo)\n\ndim(Demo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1380    6\n```\n\n\n:::\n:::\n\n\n\n\nTransform School_District using `separate`\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(as.data.frame(Demo),2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              School_District  Student_ID Race Gender Fall_Attendance\n1 Primary School - District A 71111337335    W      1          99.42%\n2 Primary School - District A 71113153739    B      2          97.08%\n  Spring_Attendance\n1             93.86\n2             93.86\n```\n\n\n:::\n\n```{.r .cell-code}\nDemo <- Demo %>% separate(School_District,into=c(\"School\",\"District\"), sep='-')\nhead(as.data.frame(Demo),2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           School    District  Student_ID Race Gender Fall_Attendance\n1 Primary School   District A 71111337335    W      1          99.42%\n2 Primary School   District A 71113153739    B      2          97.08%\n  Spring_Attendance\n1             93.86\n2             93.86\n```\n\n\n:::\n:::\n\n\n\n\nChange Fall_Attendance class into numeric using `as.numeric` and remove the % using `str_remove`\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(as.data.frame(Demo),2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           School    District  Student_ID Race Gender Fall_Attendance\n1 Primary School   District A 71111337335    W      1          99.42%\n2 Primary School   District A 71113153739    B      2          97.08%\n  Spring_Attendance\n1             93.86\n2             93.86\n```\n\n\n:::\n\n```{.r .cell-code}\nclass(Demo$Fall_Attendance)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"character\"\n```\n\n\n:::\n\n```{.r .cell-code}\nDemo <- Demo %>% mutate(Fall_Attendance=as.numeric(str_remove(Fall_Attendance,\"%\")))\nhead(as.data.frame(Demo),2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           School    District  Student_ID Race Gender Fall_Attendance\n1 Primary School   District A 71111337335    W      1           99.42\n2 Primary School   District A 71113153739    B      2           97.08\n  Spring_Attendance\n1             93.86\n2             93.86\n```\n\n\n:::\n:::\n\n\n\n\nLast, recode variables.\n\nChange Race class into a factor and recode values using `recode_factor`\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(Demo$Race)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"character\"\n```\n\n\n:::\n\n```{.r .cell-code}\ntable(Demo$Race)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   A    B    H    I    P    W \n  29   82   32   17    3 1217 \n```\n\n\n:::\n\n```{.r .cell-code}\nDemo<-Demo%>%mutate(Race=recode_factor(Race, 'W'=\"White\", 'I'=\"American Indian\",\n                                       'A'=\"Asian\", 'B'=\"Black\", 'H'=\"Latino/Hispanic\",\n                                       'P'=\"Native Hawaiian/Pacific Islander\"))\n\nlevels(Demo$Race)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"White\"                            \"American Indian\"                 \n[3] \"Asian\"                            \"Black\"                           \n[5] \"Latino/Hispanic\"                  \"Native Hawaiian/Pacific Islander\"\n```\n\n\n:::\n\n```{.r .cell-code}\njanitor::tabyl(Demo$Race)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                        Demo$Race    n     percent\n                            White 1217 0.881884058\n                  American Indian   17 0.012318841\n                            Asian   29 0.021014493\n                            Black   82 0.059420290\n                  Latino/Hispanic   32 0.023188406\n Native Hawaiian/Pacific Islander    3 0.002173913\n```\n\n\n:::\n:::\n\n\n\n\nChange Gender class into factor and recode values using `recode_factor`\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(Demo$Gender)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"numeric\"\n```\n\n\n:::\n\n```{.r .cell-code}\ntable(Demo$Gender)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n  1   2 \n744 636 \n```\n\n\n:::\n\n```{.r .cell-code}\nDemo<-Demo%>%mutate(Gender=recode_factor(Gender,`1`=\"Male\", `2`=\"Female\"))\n\nlevels(Demo$Gender)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Male\"   \"Female\"\n```\n\n\n:::\n:::\n\n\n\n\nAdd variable labels using `var_label`\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(Demo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"School\"            \"District\"          \"Student_ID\"       \n[4] \"Race\"              \"Gender\"            \"Fall_Attendance\"  \n[7] \"Spring_Attendance\"\n```\n\n\n:::\n\n```{.r .cell-code}\nvar_label(Demo) <- list(School = \"SchoolName\",District=\"DistrictName\", \n                                Student_ID=\"Student ID\", Race=\"Student Race\", \n                                Gender=\"Student Gender\", Fall_Attendance=\"Percent Attendance Fall\", \n                                Spring_Attendance=\"Percent Attendance Spring\")\n```\n:::\n\n\n\n\n##### While the code above works just fine, we could also write code chunks together using %\\>%. Then we only have to call the data once rather than 8 times.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDemo <- Demo %>% select(-`Student Name`, -ZipCode)%>%\n  setNames(c(\"School_District\", \"Student_ID\",\"Race\", \"Gender\",\n            \"Fall_Attendance\", \"Spring_Attendance\")) %>%\n  filter(!is.na(Student_ID)) %>% distinct() %>%\n  separate(School_District,into=c(\"School\",\"District\"), sep='-') %>%\n  mutate(Fall_Attendance=as.numeric(str_remove(Fall_Attendance,\"%\")),\n                                    Race=recode_factor(Race, 'W'=\"White\", 'I'=\"American Indian\",\n                                       'A'=\"Asian\", 'B'=\"Black\", 'H'=\"Latino/Hispanic\",\n                                       'P'=\"Native Hawaiian/Pacific Islander\"),\n                                    Gender=recode_factor(Gender,`1`=\"Male\", `2`=\"Female\"))\n```\n:::\n\n\n\n\n#### Last we can make a codebook of variable descriptives\n\nMake a codebook using `makeCodebook`\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataMaid::makeCodebook(Demo, reportTitle=\"Codebook for R-ladies Demographic Data\")\n```\n:::\n\n\n\n\n#### And we can export our data to share with others or analyze in other programs.\n\nExport Data using `write_csv`\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_csv(Demo,\"Clean_Demographics_2018_19.csv\")\n```\n:::\n\n\n\n\n#### Also, if you wanted your data in tidy format, you could restructure from wide to long\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDemoLong <- Demo %>% pivot_longer(cols=contains(\"Attend\"), \n                                          names_to=c(\"Time\",\".value\"), names_sep=\"_\")\n\nhead(as.data.frame(DemoLong))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           School    District  Student_ID  Race Gender   Time Attendance\n1 Primary School   District A 71111337335 White   Male   Fall      99.42\n2 Primary School   District A 71111337335 White   Male Spring      93.86\n3 Primary School   District A 71113153739 Black Female   Fall      97.08\n4 Primary School   District A 71113153739 Black Female Spring      93.86\n5    High School   District A 71113195575 White   Male   Fall      94.44\n6    High School   District A 71113195575 White   Male Spring      96.49\n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}